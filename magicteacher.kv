#:import Factory kivy.factory.Factory
<ScreenManagement>:
    LessonGroupScreen:
        id:screen0
        name: 'groups'
    LessonListScreen:
        id:screen1
        name: 'lessons'
    LessonTitleScreen:
        name: 'title'
    LessonFactualScreen:
        name: 'factual'
    LessonWhiteboardScreen:
        name: 'whiteboard'
    LessonNotesScreen:
        name: 'notes'
    LessonApplyScreen:
        name: 'apply'
    LessonAssessScreen:
        name: 'assess'

<ImportPop>
    text_userid: user.text
    text_classid: classid.text
    text_lessonid: lesson.text
    orientation: 'vertical'
    GridLayout:
        cols:2
        #row_force_default:True
        #row_default_height:40
        padding:[20,20,20,20]
        spacing:[20,20]
        Label:
            text:"User ID"
            size_hint_x:0.2

        TextInput:
            id:user
            write_tab: False
            multiline: False
            size_hint_x:0.3
            size_hint_y:0.04
            font_size:'20sp'

        Label:
            text:"Class ID"
            size_hint_x:0.2


        TextInput:
            id:classid
            write_tab: False
            multiline: False
            size_hint_x:0.3
            size_hint_y:0.04
            font_size:'20sp'

        Label:
            text:"Lesson ID"
            size_hint_x:0.2

        TextInput:
            id:lesson
            write_tab: False
            multiline: False
            size_hint_x:0.3
            size_hint_y:0.04
            font_size:'20sp'

        Label:
            text:"Group"
            size_hint_x:0.2

        Spinner:
            id: whatever
            text: " Group A "

            halign:"left"                              #default value showed
            text_size:(300, None)
            values: root.lesson_groups      #list of values to show
            option_cls: Factory.get("DelSpinnerOption")
            on_text:
                root.on_select_group(self.text)
            background_color:[0.76,0.83,0.86,0.8]
            font_name:"Caveat-Bold"
            font_size: "30sp"


        Button:
            text: 'Submit'
            size_hint_x:0.2
            size_hint_y:0.8
            on_release: root.import_lesson(self)
            background_color:[0.76,0.83,0.86,0.8]

        Button:
            text: 'Close'
            size_hint_x:0.2
            size_hint_y:0.8
            on_release: root.close_pop()
            background_color:[0.76,0.83,0.86,0.8]
    Label:
        text: root.text_status
        size_hint:(1,0.2)
        text_size:(self.width,None)


<PublishPop>
    text_user: user.text
    text_pwd: password.text
    title:"Publish Lesson"
    BoxLayout:
        orientation: 'vertical'
        GridLayout:
            cols:2
            row_force_default:True
            row_default_height:60
            padding:[5,5,5,5]
            spacing:[20,20]
            Label:
                text:"User ID"
                size_hint_x:0.2

            TextInput:
                id:user
                write_tab: False
                multiline: False
                size_hint_x:0.3
                size_hint_y:0.04
                font_size:'20sp'

            Label:
                text:"Password"
                size_hint_x:0.2


            TextInput:
                id:password
                write_tab: False
                multiline: False
                password:True
                size_hint_x:0.3
                size_hint_y:0.04
                font_size:'20sp'


            Button:
                text: 'Submit'
                size_hint_x:0.2
                size_hint_y:0.8
                on_release: root.publish_lesson()
                background_color:[0.76,0.83,0.86,0.8]

            Button:
                text: 'Close'
                size_hint_x:0.2
                size_hint_y:0.8
                on_release: root.dismiss()
                background_color:[0.76,0.83,0.86,0.8]
        AnchorLayout:
            size_hint:(1,0.5)
            Button:
                text: 'Register'
                anchor_x:"center"
                size_hint_x:0.4
                size_hint_y:0.4
                halign:"center"
                on_release: root.register_user()
                background_color:[0.76,0.83,0.86,0.8]
        AnchorLayout:
            Label:
                text: root.text_status
                size_hint:(0.8,0.2)
                anchor_x:"center"
                halign:"center"
                text_size:(800,None)

<CreatePop>
    text_lesson_name: create.text
    text_lang:lang.text

    orientation: 'vertical'
    GridLayout:
        size_hint:(1,0.8)
        padding:[5,5,5,5]
        spacing:[20,20]
        cols:2
        row_force_default:True
        row_default_height:60


        Label:
            text:"Language"
            size_hint_x:0.2

        Spinner:
            id: lang
            text: " English "
            halign:"left"
            text_size:(300, None)
            values: ['English', 'Hindi']     #list of values to show
            option_cls: Factory.get("DelSpinnerOption")
            on_text: root.on_select_lang(self.text)
            background_color:[0.76,0.83,0.86,0.8]
        Label:
            text:"Lesson Name"
            size_hint_x:0.2

        TextInput:
            id:create
            write_tab: False
            multiline: False
            size_hint_x:0.3
            font_name:root.text_lesson_font
            on_text:root.on_title_text(self,self.text)
            font_size:'50sp'

        Label:
            text:"Group"
            size_hint_x:0.2

        Spinner:
            id: whatever
            text: " Group A "

            halign:"left"                              #default value showed
            text_size:(300, None)
            values: root.lesson_groups      #list of values to show
            option_cls: Factory.get("DelSpinnerOption")
            on_text:
                root.on_select_group(self.text)
            background_color:[0.76,0.83,0.86,0.8]
            font_name:"Caveat-Bold"
            font_size: "30sp"


        Button:
            text: 'Create'
            size_hint_x:1
            size_hint_y:0.3
            on_release: root.create_lesson(self)
            background_color:[0.76,0.83,0.86,0.8]
        Button:
            text: 'Close'
            size_hint_x:1
            size_hint_y:0.3
            on_release: root.close_pop(self)
            background_color:[0.76,0.83,0.86,0.8]
    AnchorLayout:
        size_hint:(1,0.1)
        Label:
            text:"In Hindi to get आदरणीय अध्यापिका \n you can type AdarNIya adhyApikA"
            size_hint_x:1
            font_name:"unifont.ttf"
            text_size:(self.width,None)
            anchor_x:"center"
            halign:"center"

    AnchorLayout:
        size_hint:(1,0.1)
        Label:
            text: root.text_status
            size_hint_x:1
            text_size:(self.width,None)
            anchor_x:"center"
            halign:"center"

<DelSpinnerOption@SpinnerOption>
    halign: "left"
    font_name: "Caveat-Bold.ttf"
    font_size: "25sp"
    text_size:(300,None)
    background_color:[0.76,0.83,0.86,0.8]

<DeletePop>
    #text_lessoid: user.text
    auto_dismiss:False
    size_hint:(1,0.5)
    title:"Delete Mini Lesson"
    BoxLayout:
        orientation:"vertical"
        GridLayout:
            cols:3
            padding:[20,20,20,20]
            spacing:[20,20]
            row_force_default:True
            row_default_height:"40dp"
            Label:
                text: "Select Mini Lesson"

                text_size: (200,None)

            Spinner:
                id: whatever
                text: " Select Lesson "

                halign:"left"                              #default value showed
                text_size:(300, None)
                values: root.lesson_list      #list of values to show
                font_name:"unifont.ttf"
                option_cls: Factory.get("DelSpinnerOption")
                on_text:
                    root.on_select_lesson(self.text)
                background_color:[0.76,0.83,0.86,0.8]

            Button:
                text: " Delete "
                height: "30dp"
                on_release: root.on_delete()
                background_color:[0.76,0.83,0.86,0.8]
        Label:
            text:root.status_label
            size_hint: (1,0.1)
        Button:
            text: "Close"
            size_hint: (1,0.2)
            on_release: root.dismiss()
            background_color:[0.76,0.83,0.86,0.8]

<LessonGroupScreen>

    container: container
    BoxLayout:
        orientation: 'vertical'
        ActionBar:
            pos_hint: {'top':1}

            ActionView:
                use_separator: True


                ActionPrevious:
                    app_icon: "logo_bg_small.png"

                ActionButton:
                    text: ' Create Mini Lesson '
                    on_press: root.launch_popup_create()

                ActionButton:
                    text: ' Import Mini Lesson '
                    on_press: root.launch_popup()


        ScrollView:
            size_hint: (1, 1)
            bar_width: 10
            bar_color: 1, 0, 0, 1   # red
            bar_inactive_color: 0, 0, 1, 1   # blue
            effect_cls: "ScrollEffect"
            scroll_type: ['bars']
            effect_cls: "ScrollEffect"
            BoxLayout:
                id: container
                orientation: 'vertical'
                size_hint_y:None
<LessonListScreen>

    lesson_c:lesson_c
    BoxLayout:
        orientation: 'vertical'
        ActionBar:
            pos_hint: {'top':1}

            ActionView:
                use_separator: True


                ActionPrevious:
                    app_icon: "logo_bg_small.png"
                    on_release: root.set_previous_screen()



                ActionOverflow:
                    ActionButton:
                        text: ' Delete '

                        on_press: root.launch_del_popup()

        ScrollView:
            #do_scroll_x: False
            #do_scroll_y: True
            #size_hint: (1, None)
            #size:(800,850)
            size_hint: (1, 1)
            bar_width: 10
            bar_color: 1, 0, 0, 1   # red
            bar_inactive_color: 0, 0, 1, 1   # blue
            effect_cls: "ScrollEffect"
            scroll_type: ['bars']

            BoxLayout:
                id:lesson_c
                orientation: 'vertical'
                size_hint_y:None

<ImageSelectPop>:
    title:"Select Image"
    search_query:sq.text

    BoxLayout:


        orientation:"vertical"
        spacing:[5,5]
        BoxLayout:
            spacing:[10,10]
            size_hint:(1,0.2)
            Button:
                size_hint:(0.2,0.3)
                text: "Open an Image File"
                on_release:root.file_pop()
                background_color:[0.76,0.83,0.86,0.8]

            Button:
                size_hint:(0.2,0.3)
                text: "Close Selector"
                on_release:root.dismiss()
                background_color:[0.76,0.83,0.86,0.8]

        BoxLayout:
            spacing:[10,10]
            size_hint:(1,0.2)

            TextInput:
                id:sq
                size_hint:(0.5,0.35)
                multiline:False
                hint_text: "Google Search Images"

            Button:
                size_hint:(0.2,0.35)
                text: "Search"
                on_release:root.showImages()
                background_color:[0.76,0.83,0.86,0.8]



        GridLayout:
            cols:2
            spacing:[20,20]
            id:imagelist

<imgpopup>:
    size_hint:(0.7,0.6)
    title: "Search Image"
    auto_dismiss:False
    BoxLayout:
        orientation:'vertical'


        AsyncImage:
            source:root.text_image
            #size: 400, 400/ self.image_ratio
            size_hint: (1,0.8)
            #allow_stretch:True
        GridLayout:
            size_hint: (1,0.2)
            cols:2
            row_force_default:True
            row_default_height:60
            Button:
                size_hint:(0.5,0.2)
                text:"Select This"
                on_release: root.save_selected_image()
                background_color:[0.76,0.83,0.86,0.8]

            Button:
                size_hint:(0.5,0.2)
                text:"Close"
                on_release: root.dismiss()
                background_color:[0.76,0.83,0.86,0.8]

<imgurlpopup>:


    size_hint:(0.9,0.8)
    title: "Image File"
    auto_dismiss:False
    BoxLayout:
        orientation:'vertical'
        size_hint:(0.9,1)
        pos_hint: {'top':1}
        FileChooserIconView:
            size_hint:(1,0.8)
            on_selection: root.save_selected_image(*args)

        Button:
            size_hint:(1,0.1)
            text:"Close"

            halign:"center"
            on_release: root.dismiss()
            background_color:[0.76,0.83,0.86,0.8]


<campopup>:
    size_hint:(0.9,0.8)
    title: "Take a Pic"
    auto_dismiss:False
    BoxLayout:
        orientation:'vertical'

       # Camera:
       #     id: camera
       #     play:True
       #     resolution: (640,480)


       #     canvas.before:
       #         PushMatrix
       #         Rotate:
       #             angle: -90
       #             origin: self.center
       #     canvas.after:
       #         PopMatrix


        Button:
            text: 'Capture'
            size_hint_y: None
            height: '48dp'
            on_press: root.capture()

        Button:
            text: 'Close'
            size_hint_y: None
            height: '48dp'
            on_press: root.dismiss()




<LessonTitleScreen>
    tl_image:tl_image
    text_label_1:text_description.text
    text_label_2:text_title.text
    BoxLayout:
        orientation: 'vertical'
        ActionBar:
            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    with_previous: True
                    on_release: root.set_previous_screen()
                    app_icon: "logo_bg_small.png"
                ActionButton:
                    text: ' Next '
                    on_release:root.set_next_screen()


        BoxLayout:
            orientation:'vertical'
            spacing: 30
            TextInput:
                id:text_title
                text: root.text_label_2
                size_hint: (1,0.15)
                text_size:(self.width,None)
                font_size:'50sp'
                font_name:root.font_name
                halign:"center"
                multiline:False
                on_text:root.on_title_text(self,self.text)
            BoxLayout:
                orientation:'vertical'
                Image:
                    id:tl_image
                    source:root.text_image
                    size: 350, 350/ self.image_ratio
                    size_hint: (1,0.4)
                    allow_stretch: True

                AnchorLayout:
                    size_hint:(1,0.15)
                    Button:
                        text: 'Add Image'
                        size_hint:(0.5,0.25)
                        anchor_x:"center"
                        on_press: root.launch_image_selector()
                        background_color:[0.76,0.83,0.86,0.8]


            ScrollView:
                id: scrlv
                size_hint:(1,0.3)
                bar_width: 10
                bar_color: 1, 0, 0, 1   # red
                bar_inactive_color: 0, 0, 1, 1   # blue
                effect_cls: "ScrollEffect"
                scroll_type: ['bars']

                TextInput:
                    id:text_description
                    font_size:'50sp'
                    font_name : root.font_name

                    use_bubble:True
                    use_handles:True
                    height: max(self.minimum_height, scrlv.height)
                    on_text:root.on_title_desc_text(self,self.text)
                    text:root.text_label_1
                    size_hint_y: None
                    halign:"center"
                    text_size: self.width, None


<LessonFactualScreen>
    display_image:display_image
    text_term_display : term.text
    text_term_description:description.text
    BoxLayout:
        orientation: 'vertical'

        ActionBar:
            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    with_previous: True
                    app_icon: "logo_bg_small.png"
                    on_release: root.set_previous_screen()
                ActionButton:
                    text: ' Next '
                    on_release:root.set_next_screen()

        BoxLayout:

            size_hint:(0.2,0.03)
            pos_hint:{'x': 0.4,'top':1}

            Button:
                text: '<'
                #size_hint:(0.06,0.15)
                on_press:root.load_previous()
                height:1
                width:1
                background_color:[0.76,0.83,0.86,0.8]
            Button:
                text: '>'
                #size_hint:(0.06,0.15)
                height:1
                width:1
                on_press:root.load_next()
                background_color:[0.76,0.83,0.86,0.8]


        BoxLayout:
            orientation:'vertical'
            size_hint:(1,0.8)
            Image:
                id:display_image
                size_hint:(1,0.6)
                auto_stretch:True
                source:root.text_image_display

            AnchorLayout:
                size_hint:(1,0.2)
                Button:
                    text: 'Add Image'
                    size_hint:(0.5,0.1)
                    anchor_x:"center"
                    on_press: root.launch_image_selector()
                    background_color:[0.76,0.83,0.86,0.8]
            TextInput:
                id:term
                text:root.text_term_display
                font_name:root.font_name
                on_text:root.on_term_text(self,self.text)
                font_size:"50sp"
                multiline:False
                size_hint:(1,0.2)
                halign:"center"

            ScrollView:
                id:scrlv
                size_hint:(1,0.3)
                bar_width: 10
                bar_color: 1, 0, 0, 1   # red
                bar_inactive_color: 0, 0, 1, 1   # blue
                effect_cls: "ScrollEffect"
                scroll_type: ['bars']
                TextInput:
                    id:description
                    #size_hint:(1,0.3)
                    text:root.text_term_description
                    text_size: self.width, None
                    font_name:root.font_name
                    on_text:root.on_description_text(self,self.text)
                    font_size: "50sp"
                    height: max(self.minimum_height, scrlv.height)
                    halign:"center"
                    valign:"top"
                    size_hint_y: None

<LessonApplyScreen>
    steps: steps
    #images: images
    BoxLayout:

        orientation: 'vertical'
        ActionBar:
            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    with_previous: True
                    on_release: root.set_previous_screen()
                    app_icon: "logo_bg_small.png"
                ActionButton:
                    text: ' Next '
                    on_release:root.set_next_screen()



        BoxLayout:
            orientation: 'vertical'
            Label:
                size_hint:(1,0.1)
                font_size: "50sp"
                text: "Sequence of Facts or Steps"
            ScrollView:
                id: scrlv1
                size_hint: (1, 1)
                BoxLayout:
                    orientation:'vertical'
                    pos_hint: {'top': 1}

                    id: steps
                    height: max(self.minimum_height, scrlv1.height)
                    size_hint_y:None
<imgwhiteboardpopup>:
    size_hint:(1,1)
    img_wb:img_wb
    title: root.text_image_presence

    BoxLayout:
        orientation:'vertical'
        Image:
            id:img_wb
            source:root.whiteboard_image
            size: 500, 500/ self.image_ratio
            #size_hint: (0.7,0.6)
            #allow_stretch:True
        Button:
            text: 'Close'
            size_hint_x:1
            size_hint_y:0.2
            on_release: root.dismiss()
            background_color:[0.76,0.83,0.86,0.8]

<lessonpurchasepopup>:
    size_hint:(0.5,0.5)
    auto_dismiss:True
    title: "Lesson Top Up"

    BoxLayout:
        orientation:'vertical'

        Label:
            text:"Top up Lesson Sharing @ Re 1 per lesson.Click Below"
            text_size:(self.width,None)
            halign:"center"

        Button:
            text:"Lesson Top Up"
            size_hint:(1,0.2)
            halign:"center"
            on_release:root.lesson_purchase()
            background_color:[0.76,0.83,0.86,0.8]

<LessonWhiteboardScreen>
    cw:cw
    sv:sv
    blay:blay

    BoxLayout:
        id:blay
        orientation: 'vertical'
        ActionBar:

            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    with_previous: True
                    on_release: root.set_previous_screen()
                    app_icon: "logo_bg_small.png"
                ActionButton:
                    text: ' Last Saved '
                    on_release:root.open_last_saved()

                ActionButton:
                    text: ' Next '
                    on_release:root.set_next_screen()
        BoxLayout:
            height:"50sp"
            pos_hint: {'top': 1}
            size_hint:(1,None)
            Button:
                text:"save"
                valign:"top"
                size_hint:(0.3,None)
                height:"40sp"
                on_release:root.save_canvas(root.sv)
                background_color:[0.76,0.83,0.86,0.8]
            Button:
                text:"clear"
                size_hint:(0.3,None)
                height:"40sp"
                on_release:root.cw.clear()
                background_color:[0.76,0.83,0.86,0.8]
            ToggleButton:
                text: root.cw.text_button
                on_state: root.cw.erase() if self.state == 'down' else root.cw.pen()
                size_hint:(0.3,None)
                height:"40sp"
                background_color:[0.76,0.83,0.86,0.8]


        StencilView:
            id:sv
            size_hint:(1,0.8)
            CWidget:
                size_hint:(1,None)
                id:cw



<LessonNotesScreen>
    text_label_1: txt.text
    txt:txt
    BoxLayout:
        orientation: 'vertical'
        ActionBar:
            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    with_previous: True
                    on_release: root.set_previous_screen()
                    app_icon: "logo_bg_small.png"
                ActionButton:
                    text: 'Next'
                    on_release:root.set_next_screen()
        ScrollView:
            padding:[20,20,20,20]
            id: scrlv
            size_hint:(1,0.7)
            bar_width: 10
            bar_color: 1, 0, 0, 1   # red
            bar_inactive_color: 0, 0, 1, 1   # blue
            effect_cls: "ScrollEffect"
            scroll_type: ['bars']
            TextInput:
                id:txt
                size_hint:(1,None)
                hint_text:"Descriptive Texts and Explanations"
                font_size:"50sp"
                on_text:root.on_description_text(self,self.text)
                font_name : root.font_name
                multiline:True
                text_size: self.width, None
                height: max(self.minimum_height, scrlv.height)
                text:root.text_label_1
        Button:
            size_hint:(1,0.15)
            text:"Paste"
            on_release: root.txt.paste()
            background_color:[0.76,0.83,0.86,0.8]

<LessonAssessScreen>
    text_label_1: txt.text
    text_label_2: txt_form.text
    txt_form:txt_form
    BoxLayout:
        orientation: 'vertical'
        ActionBar:
            pos_hint: {'top':1}
            ActionView:
                use_separator: True
                ActionPrevious:
                    with_previous: True
                    on_release: root.set_previous_screen()
                    app_icon: "logo_bg_small.png"
                ActionButton:
                    text: ' Publish '
                    on_release:root.publish_lesson()
                ActionButton:
                    text: ' Done '
                    on_release:root.set_next_screen()
        ScrollView:
            padding:[20,20,20,20]
            id: scrlv
            size_hint:(1,0.7)
            bar_width: 10
            bar_color: 1, 0, 0, 1   # red
            bar_inactive_color: 0, 0, 1, 1   # blue
            effect_cls: "ScrollEffect"
            scroll_type: ['bars']
            TextInput:
                id:txt
                size_hint:(1,None)
                hint_text:"Questions for Assessment"
                font_size:"50sp"
                font_name:root.font_name
                on_text:root.on_description_text(self,self.text)
                multiline:True
                text_size: self.width, None
                height: max(self.minimum_height, scrlv.height)
                text:root.text_label_1
        TextInput:
            id:txt_form
            size_hint:(1,0.1)
            hint_text:"Add External Link, paste the full link including http://"
            font_size:"15sp"
            multiline:False
            text_size: self.width, None

            text:root.text_label_2
        Button:
            size_hint:(1,0.15)
            text:"Paste External Link"
            on_release: root.txt_form.paste()
            background_color:[0.76,0.83,0.86,0.8]
